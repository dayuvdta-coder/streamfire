<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>
    <%= title %>
  </title>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    body {
      font-family: 'Outfit', sans-serif;
      background-color: #f0f9ff;
    }

    ::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }

    ::-webkit-scrollbar-track {
      background: #fff;
      border-left: 2px solid #000;
    }

    ::-webkit-scrollbar-thumb {
      background: #000;
      border: 2px solid #fff;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #222;
    }
  </style>
</head>

<body class="text-black antialiased selection:bg-yellow-400 selection:text-black">

  <%- include('partials/header', { path: '/' }) %>

    <div class="md:ml-64 min-h-screen flex flex-col transition-all duration-300">

      <header
        class="h-16 border-b-2 border-black bg-white sticky top-0 z-30 flex items-center justify-between px-4 md:px-8">
        <div class="flex items-center gap-4">
          <button id="open-sidebar" class="md:hidden text-black hover:text-gray-700 transition-colors">
            <i class="fas fa-bars text-xl"></i>
          </button>
          <h1 class="text-2xl font-black text-black italic tracking-tighter">
            <%= t.dashboard %>
          </h1>
        </div>
        <div>
          <button id="add-video-btn"
            class="bg-cyan-400 text-black border-2 border-black px-4 py-2 text-sm font-bold shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:translate-x-[2px] hover:translate-y-[2px] hover:shadow-none transition-all flex items-center gap-2">
            <i class="fas fa-plus"></i>
            <span class="hidden sm:inline">
              <%= t.new_stream %>
            </span>
          </button>
        </div>
      </header>

      <main class="flex-1 p-4 md:p-8 max-w-7xl mx-auto w-full">

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
          <div
            class="bg-pink-400 border-2 border-black p-5 shadow-[5px_5px_0px_0px_rgba(0,0,0,1)] flex items-center gap-5">
            <div
              class="w-12 h-12 bg-white border-2 border-black flex items-center justify-center text-black shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]">
              <i class="fas fa-video text-xl"></i>
            </div>
            <div>
              <div class="text-black text-xs font-bold uppercase tracking-wider mb-1">
                <%= t.total_videos %>
              </div>
              <div class="text-3xl font-black text-black">
                <%= videos.length %>
              </div>
            </div>
          </div>

          <div
            class="bg-lime-400 border-2 border-black p-5 shadow-[5px_5px_0px_0px_rgba(0,0,0,1)] flex items-center gap-5">
            <div
              class="w-12 h-12 bg-white border-2 border-black flex items-center justify-center text-black shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]">
              <i class="fas fa-signal text-xl"></i>
            </div>
            <div>
              <div class="text-black text-xs font-bold uppercase tracking-wider mb-1">
                <%= t.active_streams %>
              </div>
              <div class="text-3xl font-black text-black" id="active-count">0</div>
            </div>
          </div>

          <div
            class="bg-white border-2 border-black p-5 shadow-[5px_5px_0px_0px_rgba(0,0,0,1)] flex flex-col justify-center">
            <div class="flex justify-between items-end mb-2">
              <div class="text-black text-xs font-bold uppercase tracking-wider">
                <%= t.cpu_load %>
              </div>
              <div class="text-black text-xs font-mono font-bold" id="cpu-text">0%</div>
            </div>
            <div class="w-full bg-gray-200 border-2 border-black h-4 overflow-hidden">
              <div class="bg-cyan-400 h-full border-r-2 border-black transition-all duration-500" id="cpu-bar"
                style="width: 0%"></div>
            </div>
            <div class="flex justify-between items-end mt-3 mb-2">
              <div class="text-black text-xs font-bold uppercase tracking-wider">
                <%= t.ram_usage %>
              </div>
              <div class="text-black text-xs font-mono font-bold" id="ram-text">0%</div>
            </div>
            <div class="w-full bg-gray-200 border-2 border-black h-4 overflow-hidden">
              <div class="bg-yellow-400 h-full border-r-2 border-black transition-all duration-500" id="ram-bar"
                style="width: 0%"></div>
            </div>
          </div>
        </div>

        <section class="mb-8 bg-white border-2 border-black p-5 shadow-[5px_5px_0px_0px_rgba(0,0,0,1)]">
          <div
            class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4 border-b-2 border-black pb-3">
            <h2 class="text-lg md:text-xl font-black uppercase tracking-wide flex items-center gap-2">
              <i class="fab fa-youtube"></i>
              Quick Stream from URL
            </h2>
            <div id="url-stream-pill"
              class="inline-flex items-center gap-2 text-[11px] font-bold uppercase px-3 py-1 border-2 border-black bg-gray-100">
              <span class="w-2 h-2 rounded-full bg-gray-500"></span>
              <span>OFFLINE</span>
            </div>
          </div>

          <div class="grid grid-cols-1 xl:grid-cols-3 gap-4">
            <div class="space-y-3 xl:col-span-2">
              <label class="text-[11px] font-bold uppercase block">Source URL (YouTube / direct video URL)</label>
              <input id="url-stream-source" type="text"
                class="w-full bg-gray-50 border-2 border-black px-3 py-2 text-xs font-mono outline-none focus:bg-yellow-100"
                placeholder="https://www.youtube.com/watch?v=xxxx">
              <div class="grid grid-cols-3 gap-2">
                <select id="url-stream-res"
                  class="bg-gray-50 border-2 border-black px-2 py-2 text-[10px] font-bold outline-none focus:bg-yellow-100">
                  <option value="1280x720" selected>1280x720</option>
                  <option value="852x480">852x480</option>
                  <option value="1920x1080">1920x1080</option>
                  <option value="720x1280">720x1280</option>
                </select>
                <select id="url-stream-fps"
                  class="bg-gray-50 border-2 border-black px-2 py-2 text-[10px] font-bold outline-none focus:bg-yellow-100">
                  <option value="30" selected>30 FPS</option>
                  <option value="24">24 FPS</option>
                  <option value="60">60 FPS</option>
                </select>
                <select id="url-stream-bitrate"
                  class="bg-gray-50 border-2 border-black px-2 py-2 text-[10px] font-bold outline-none focus:bg-yellow-100">
                  <option value="2500k">2500k</option>
                  <option value="3500k" selected>3500k</option>
                  <option value="4500k">4500k</option>
                  <option value="6000k">6000k</option>
                </select>
              </div>
              <p class="text-[10px] font-medium text-gray-600">
                Cocok buat live cepat tanpa upload file lokal. Untuk YouTube diproses via `yt-dlp` + FFmpeg.
              </p>
            </div>

            <div class="space-y-3">
              <label class="text-[11px] font-bold uppercase block">RTMP Destination(s)</label>
              <textarea id="url-stream-destinations"
                class="w-full bg-gray-50 border-2 border-black p-2 text-[11px] font-mono h-28 outline-none focus:bg-yellow-100"
                placeholder="Satu RTMP per baris, contoh:\nrtmp://a.rtmp.youtube.com/live2/xxxx\nrtmps://live-api-s.facebook.com:443/rtmp/xxxx"></textarea>
              <div class="grid grid-cols-2 gap-2">
                <button id="url-stream-start-btn"
                  class="w-full bg-cyan-400 hover:bg-cyan-300 border-2 border-black font-black text-xs py-2 uppercase shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[2px] active:translate-y-[2px] transition-all">
                  Start URL Stream
                </button>
                <button id="url-stream-stop-btn"
                  class="w-full bg-red-500 text-white hover:bg-red-600 border-2 border-black font-black text-xs py-2 uppercase transition-all">
                  Stop
                </button>
              </div>
              <div id="url-stream-status"
                class="bg-gray-50 border-2 border-black p-2 text-[11px] font-mono leading-relaxed break-words">
                URL stream offline.
              </div>
            </div>
          </div>
        </section>

        <section class="mb-8 bg-white border-2 border-black p-5 shadow-[5px_5px_0px_0px_rgba(0,0,0,1)]">
          <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4 border-b-2 border-black pb-3">
            <h2 class="text-lg md:text-xl font-black uppercase tracking-wide flex items-center gap-2">
              <i class="fab fa-instagram"></i>
              Instagram Live
            </h2>
            <div class="flex items-center gap-2">
              <div id="ig-pill"
                class="inline-flex items-center gap-2 text-[11px] font-bold uppercase px-3 py-1 border-2 border-black bg-gray-100">
                <span class="w-2 h-2 rounded-full bg-gray-500"></span>
                <span>Disconnected</span>
              </div>
              <div id="ig-ffmpeg-pill"
                class="inline-flex items-center gap-2 text-[11px] font-bold uppercase px-3 py-1 border-2 border-black bg-gray-100">
                <span class="w-2 h-2 rounded-full bg-gray-500"></span>
                <span>FFMPEG OFFLINE</span>
              </div>
            </div>
          </div>

          <div class="grid grid-cols-1 xl:grid-cols-3 gap-4">
            <div class="space-y-3">
              <label class="text-[11px] font-bold uppercase block">Login Instagram (2 Opsi)</label>
              <div class="bg-cyan-50 border-2 border-black p-2">
                <div class="text-[10px] font-black uppercase mb-2">A. Via Cookie</div>
              <textarea id="ig-cookie"
                class="w-full bg-gray-50 border-2 border-black p-3 text-xs font-mono h-28 outline-none focus:bg-yellow-100"
                placeholder="sessionid=...; csrftoken=...;"></textarea>
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                <input id="ig-cookie-name" type="text"
                  class="w-full bg-gray-50 border-2 border-black px-3 py-2 text-xs font-bold outline-none focus:bg-yellow-100"
                  placeholder="Nama cookie (opsional)">
                <select id="ig-cookie-saved-select"
                  class="w-full bg-gray-50 border-2 border-black px-3 py-2 text-xs font-bold outline-none focus:bg-yellow-100">
                  <option value="">Pilih cookie tersimpan</option>
                </select>
              </div>
              <div class="grid grid-cols-3 gap-2">
                <button id="ig-cookie-save-btn"
                  class="w-full bg-yellow-300 hover:bg-yellow-200 border-2 border-black font-black text-[11px] py-2 uppercase shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[1px] active:translate-y-[1px] transition-all">
                  Simpan
                </button>
                <button id="ig-cookie-apply-btn"
                  class="w-full bg-cyan-300 hover:bg-cyan-200 border-2 border-black font-black text-[11px] py-2 uppercase shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[1px] active:translate-y-[1px] transition-all">
                  Pakai
                </button>
                <button id="ig-cookie-delete-btn"
                  class="w-full bg-red-400 hover:bg-red-300 border-2 border-black font-black text-[11px] py-2 uppercase shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[1px] active:translate-y-[1px] transition-all">
                  Hapus
                </button>
              </div>
              </div>
              <button id="ig-login-btn"
                class="w-full bg-pink-400 hover:bg-pink-300 border-2 border-black font-black text-xs py-2 uppercase shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[2px] active:translate-y-[2px] transition-all">
                Login via Cookie
              </button>
              <div class="bg-lime-50 border-2 border-black p-2 space-y-2">
                <div class="text-[10px] font-black uppercase">B. Via Login Instagram</div>
                <input id="ig-login-username" type="text"
                  class="w-full bg-white border-2 border-black px-3 py-2 text-xs font-bold outline-none focus:bg-yellow-100"
                  placeholder="Username Instagram">
                <input id="ig-login-password" type="password"
                  class="w-full bg-white border-2 border-black px-3 py-2 text-xs font-bold outline-none focus:bg-yellow-100"
                  placeholder="Password Instagram">
                <button id="ig-login-account-btn"
                  class="w-full bg-lime-400 hover:bg-lime-300 border-2 border-black font-black text-xs py-2 uppercase shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[2px] active:translate-y-[2px] transition-all">
                  Login via Instagram
                </button>
              </div>
              <p class="text-[10px] font-medium text-gray-600">
                Opsi cepat: login langsung pakai akun Instagram. Jika akun minta challenge/2FA, lanjutkan dengan opsi cookie.
              </p>
            </div>

            <div class="space-y-3">
              <label class="text-[11px] font-bold uppercase block">Setup Room Live</label>
              <input id="ig-title" type="text"
                class="w-full bg-gray-50 border-2 border-black px-3 py-2 text-xs font-bold outline-none focus:bg-yellow-100"
                placeholder="Judul live">
              <select id="ig-audience"
                class="w-full bg-gray-50 border-2 border-black px-3 py-2 text-xs font-bold outline-none focus:bg-yellow-100">
                <option value="Public">Public</option>
                <option value="Practice">Practice</option>
                <option value="Close friends">Close friends</option>
              </select>
              <button id="ig-setup-btn"
                class="w-full bg-lime-400 hover:bg-lime-300 border-2 border-black font-black text-xs py-2 uppercase shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[2px] active:translate-y-[2px] transition-all">
                Setup Live (Get Key)
              </button>
              <input id="ig-stream-url" type="text"
                class="w-full bg-gray-50 border-2 border-black px-3 py-2 text-[11px] font-mono outline-none focus:bg-yellow-100"
                placeholder="RTMPS URL (auto/manual)">
              <input id="ig-stream-key" type="text"
                class="w-full bg-gray-50 border-2 border-black px-3 py-2 text-[11px] font-mono outline-none focus:bg-yellow-100"
                placeholder="Stream Key (auto/manual)">
              <div class="grid grid-cols-2 gap-2">
                <button id="ig-go-btn"
                  class="w-full bg-black text-white hover:bg-gray-800 border-2 border-black font-black text-[11px] py-2 uppercase transition-all">
                  Go Live
                </button>
                <button id="ig-end-btn"
                  class="w-full bg-red-500 text-white hover:bg-red-600 border-2 border-black font-black text-[11px] py-2 uppercase transition-all">
                  End Live
                </button>
              </div>
            </div>

            <div class="space-y-3">
              <label class="text-[11px] font-bold uppercase block">Stream Video ke Instagram</label>
              <select id="ig-video"
                class="w-full bg-gray-50 border-2 border-black px-3 py-2 text-xs font-bold outline-none focus:bg-yellow-100">
                <% if (videos.length===0) { %>
                  <option value="">Belum ada video</option>
                  <% } else { %>
                    <% videos.forEach((video)=> { %>
                      <option value="<%= video.id %>">
                        #<%= video.id %> - <%= video.title %>
                      </option>
                      <% }) %>
                        <% } %>
              </select>

              <div class="grid grid-cols-3 gap-2">
                <select id="ig-res"
                  class="bg-gray-50 border-2 border-black px-2 py-2 text-[10px] font-bold outline-none focus:bg-yellow-100">
                  <option value="720x1280">720x1280</option>
                  <option value="1080x1920">1080x1920</option>
                  <option value="540x960">540x960</option>
                </select>
                <select id="ig-fps"
                  class="bg-gray-50 border-2 border-black px-2 py-2 text-[10px] font-bold outline-none focus:bg-yellow-100">
                  <option value="30">30 FPS</option>
                  <option value="24">24 FPS</option>
                  <option value="60">60 FPS</option>
                </select>
                <select id="ig-bit"
                  class="bg-gray-50 border-2 border-black px-2 py-2 text-[10px] font-bold outline-none focus:bg-yellow-100">
                  <option value="2500k">2500k</option>
                  <option value="3500k" selected>3500k</option>
                  <option value="4500k">4500k</option>
                  <option value="6000k">6000k</option>
                </select>
              </div>

              <label class="flex items-center gap-2 text-[11px] font-bold uppercase">
                <input id="ig-loop" type="checkbox" class="accent-black w-4 h-4 border-2 border-black">
                Loop video
              </label>

              <div class="space-y-1">
                <label class="text-[11px] font-bold uppercase block">Multi Stream Mirror (Opsional)</label>
                <textarea id="ig-multi-rtmp"
                  class="w-full bg-gray-50 border-2 border-black p-2 text-[11px] font-mono h-20 outline-none focus:bg-yellow-100"
                  placeholder="Satu RTMP per baris, contoh:\nrtmp://live.twitch.tv/app/xxxx\nrtmps://live-api-s.facebook.com:443/rtmp/xxxx"></textarea>
              </div>

              <button id="ig-start-btn" data-running="false"
                class="w-full bg-cyan-400 hover:bg-cyan-300 border-2 border-black font-black text-xs py-2 uppercase shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[2px] active:translate-y-[2px] transition-all">
                Start IG Stream
              </button>
            </div>
          </div>

          <div id="ig-status"
            class="mt-4 bg-gray-50 border-2 border-black p-3 text-[11px] font-mono leading-relaxed break-words">
            Loading Instagram status...
          </div>

          <div class="mt-4 grid grid-cols-1 xl:grid-cols-2 gap-4">
            <div class="bg-gray-50 border-2 border-black p-3">
              <div class="flex items-center justify-between mb-2">
                <h3 class="text-xs font-black uppercase">Live Chat Monitor</h3>
                <button id="ig-comments-refresh"
                  class="bg-white border-2 border-black px-2 py-1 text-[10px] font-bold uppercase hover:bg-yellow-200 transition-all">
                  Refresh
                </button>
              </div>
              <div id="ig-comments-list"
                class="h-48 overflow-y-auto bg-white border-2 border-black p-2 text-[11px] font-mono leading-relaxed">
                Belum ada komentar live.
              </div>
            </div>

            <div class="bg-gray-50 border-2 border-black p-3 space-y-2">
              <h3 class="text-xs font-black uppercase">Kirim Komentar</h3>
              <textarea id="ig-comment-input"
                class="w-full bg-white border-2 border-black p-2 text-xs font-mono h-32 outline-none focus:bg-yellow-100"
                placeholder="Tulis komentar untuk live chat..."></textarea>
              <button id="ig-comment-send"
                class="w-full bg-emerald-400 hover:bg-emerald-300 border-2 border-black font-black text-xs py-2 uppercase shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[2px] active:translate-y-[2px] transition-all">
                Send Comment
              </button>
            </div>
          </div>

          <div class="mt-4 bg-gray-50 border-2 border-black p-3 space-y-3">
            <div class="flex items-center justify-between gap-2">
              <h3 class="text-xs font-black uppercase">Auto Reply AI (Mistral + Template)</h3>
              <div id="ig-autoreply-pill"
                class="inline-flex items-center gap-2 text-[10px] font-bold uppercase px-2 py-1 border-2 border-black bg-white">
                <span class="w-2 h-2 rounded-full bg-gray-500"></span>
                <span>OFF</span>
              </div>
            </div>

            <div class="grid grid-cols-1 xl:grid-cols-3 gap-3">
              <label class="flex items-center gap-2 text-[11px] font-bold uppercase">
                <input id="ig-autoreply-enabled" type="checkbox" class="accent-black w-4 h-4 border-2 border-black">
                Enable Auto Reply
              </label>
              <select id="ig-autoreply-mode"
                class="bg-white border-2 border-black px-2 py-2 text-[11px] font-bold outline-none focus:bg-yellow-100">
                <option value="template_first">Template + AI Fallback</option>
                <option value="template_only">Template Only</option>
                <option value="ai_only">AI Only</option>
              </select>
              <div class="grid grid-cols-2 gap-2">
                <input id="ig-autoreply-cooldown" type="number" min="0" step="1"
                  class="bg-white border-2 border-black px-2 py-2 text-[11px] font-bold outline-none focus:bg-yellow-100"
                  placeholder="Cooldown(s)">
                <input id="ig-autoreply-max-user" type="number" min="1" step="1"
                  class="bg-white border-2 border-black px-2 py-2 text-[11px] font-bold outline-none focus:bg-yellow-100"
                  placeholder="Max/user">
              </div>
            </div>

            <div class="grid grid-cols-1 xl:grid-cols-3 gap-3">
              <input id="ig-autoreply-replies-per-comment" type="number" min="1" step="1"
                class="bg-white border-2 border-black px-2 py-2 text-[11px] font-bold outline-none focus:bg-yellow-100"
                placeholder="Balasan / komentar">
              <label class="flex items-center gap-2 text-[11px] font-bold uppercase">
                <input id="ig-autoreply-followup-enabled" type="checkbox"
                  class="accent-black w-4 h-4 border-2 border-black">
                Follow-up Otomatis
              </label>
              <input id="ig-autoreply-followup-delay" type="number" min="3" step="1"
                class="bg-white border-2 border-black px-2 py-2 text-[11px] font-bold outline-none focus:bg-yellow-100"
                placeholder="Delay follow-up(s)">
            </div>

            <input id="ig-autoreply-price" type="text"
              class="w-full bg-white border-2 border-black px-3 py-2 text-xs font-mono outline-none focus:bg-yellow-100"
              placeholder="Info harga default (contoh: Rp99.000 / pcs)">

            <textarea id="ig-autoreply-templates"
              class="w-full bg-white border-2 border-black p-2 text-[11px] font-mono h-28 outline-none focus:bg-yellow-100"
              placeholder="Template per baris format:\nkeyword1,keyword2 | Halo @{username}, harga {price}. Mau checkout?\norder,beli | Siap kak @{username}, lanjut DM ya."></textarea>

            <textarea id="ig-autoreply-followup-templates"
              class="w-full bg-white border-2 border-black p-2 text-[11px] font-mono h-20 outline-none focus:bg-yellow-100"
              placeholder="Follow-up template per baris:\nKak @{username}, kalau cocok langsung checkout/DM ya.\nStok berjalan kak @{username}, boleh saya proses sekarang?"></textarea>

            <textarea id="ig-autoreply-system"
              class="w-full bg-white border-2 border-black p-2 text-[11px] font-mono h-24 outline-none focus:bg-yellow-100"
              placeholder="System prompt AI Mistral"></textarea>

            <div class="grid grid-cols-1 sm:grid-cols-3 gap-2">
              <button id="ig-autoreply-save"
                class="w-full bg-yellow-300 hover:bg-yellow-200 border-2 border-black font-black text-xs py-2 uppercase shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[2px] active:translate-y-[2px] transition-all">
                Save Auto Reply
              </button>
              <button id="ig-autoreply-runonce"
                class="w-full bg-cyan-300 hover:bg-cyan-200 border-2 border-black font-black text-xs py-2 uppercase shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[2px] active:translate-y-[2px] transition-all">
                Run Once
              </button>
              <button id="ig-autoreply-refresh"
                class="w-full bg-white hover:bg-gray-100 border-2 border-black font-black text-xs py-2 uppercase shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[2px] active:translate-y-[2px] transition-all">
                Refresh Setting
              </button>
            </div>

            <div id="ig-autoreply-status"
              class="bg-white border-2 border-black p-2 text-[11px] font-mono leading-relaxed break-words">
              Auto-reply belum dikonfigurasi.
            </div>
          </div>
        </section>

        <section class="mb-8 bg-white border-2 border-black p-5 shadow-[5px_5px_0px_0px_rgba(0,0,0,1)]">
          <div
            class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4 border-b-2 border-black pb-3">
            <h2 class="text-lg md:text-xl font-black uppercase tracking-wide flex items-center gap-2">
              <i class="fas fa-comments"></i>
              Multi Platform Chat
            </h2>
            <div id="mp-chat-pill"
              class="inline-flex items-center gap-2 text-[11px] font-bold uppercase px-3 py-1 border-2 border-black bg-gray-100">
              <span class="w-2 h-2 rounded-full bg-gray-500"></span>
              <span>IDLE</span>
            </div>
          </div>

          <div class="grid grid-cols-1 xl:grid-cols-3 gap-4">
            <div class="bg-gray-50 border-2 border-black p-3 space-y-2">
              <label class="text-[11px] font-bold uppercase block">Platform Chat Aktif</label>
              <select id="mp-platform"
                class="w-full bg-white border-2 border-black px-3 py-2 text-xs font-bold outline-none focus:bg-yellow-100">
                <option value="youtube">YouTube</option>
                <option value="facebook">Facebook</option>
              </select>
              <button id="mp-refresh"
                class="w-full bg-cyan-300 hover:bg-cyan-200 border-2 border-black font-black text-xs py-2 uppercase shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[2px] active:translate-y-[2px] transition-all">
                Refresh Chat
              </button>
              <p class="text-[10px] font-medium text-gray-600">
                Pilih platform dulu, lalu monitor komentar realtime dan kirim komentar manual.
              </p>
            </div>

            <div class="bg-gray-50 border-2 border-black p-3 space-y-2">
              <h3 class="text-xs font-black uppercase">YouTube API</h3>
              <input id="mp-yt-stream-id" type="text"
                class="w-full bg-white border-2 border-black px-3 py-2 text-[11px] font-mono outline-none focus:bg-yellow-100"
                placeholder="videoId / streamId">
              <input id="mp-yt-livechat-id" type="text"
                class="w-full bg-white border-2 border-black px-3 py-2 text-[11px] font-mono outline-none focus:bg-yellow-100"
                placeholder="liveChatId (opsional, auto resolve)">
              <input id="mp-yt-api-key" type="text"
                class="w-full bg-white border-2 border-black px-3 py-2 text-[11px] font-mono outline-none focus:bg-yellow-100"
                placeholder="YouTube API Key (opsional)">
              <input id="mp-yt-access-token" type="password"
                class="w-full bg-white border-2 border-black px-3 py-2 text-[11px] font-mono outline-none focus:bg-yellow-100"
                placeholder="YouTube OAuth Access Token (untuk kirim komentar)">
              <input id="mp-yt-self-channel-id" type="text"
                class="w-full bg-white border-2 border-black px-3 py-2 text-[11px] font-mono outline-none focus:bg-yellow-100"
                placeholder="Self Channel ID (opsional, anti auto-reply ke diri sendiri)">
            </div>

            <div class="bg-gray-50 border-2 border-black p-3 space-y-2">
              <h3 class="text-xs font-black uppercase">Facebook API</h3>
              <input id="mp-fb-live-video-id" type="text"
                class="w-full bg-white border-2 border-black px-3 py-2 text-[11px] font-mono outline-none focus:bg-yellow-100"
                placeholder="Facebook Live Video ID">
              <input id="mp-fb-page-token" type="password"
                class="w-full bg-white border-2 border-black px-3 py-2 text-[11px] font-mono outline-none focus:bg-yellow-100"
                placeholder="Page Access Token">
              <input id="mp-fb-page-id" type="text"
                class="w-full bg-white border-2 border-black px-3 py-2 text-[11px] font-mono outline-none focus:bg-yellow-100"
                placeholder="Page ID (opsional, anti auto-reply ke diri sendiri)">
              <button id="mp-settings-save"
                class="w-full bg-yellow-300 hover:bg-yellow-200 border-2 border-black font-black text-xs py-2 uppercase shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[2px] active:translate-y-[2px] transition-all">
                Save Chat API Setting
              </button>
              <p class="text-[10px] font-medium text-gray-600">
                Token disimpan lokal di server (`db/multichat.settings.json`).
              </p>
            </div>
          </div>

          <div class="mt-4 grid grid-cols-1 xl:grid-cols-2 gap-4">
            <div class="bg-gray-50 border-2 border-black p-3">
              <h3 class="text-xs font-black uppercase mb-2">Komentar Live (YouTube/Facebook)</h3>
              <div id="mp-comments-list"
                class="h-48 overflow-y-auto bg-white border-2 border-black p-2 text-[11px] font-mono leading-relaxed">
                Belum ada komentar live.
              </div>
            </div>
            <div class="bg-gray-50 border-2 border-black p-3 space-y-2">
              <h3 class="text-xs font-black uppercase">Kirim Komentar Manual</h3>
              <textarea id="mp-comment-input"
                class="w-full bg-white border-2 border-black p-2 text-xs font-mono h-32 outline-none focus:bg-yellow-100"
                placeholder="Tulis komentar untuk platform aktif..."></textarea>
              <button id="mp-comment-send"
                class="w-full bg-emerald-400 hover:bg-emerald-300 border-2 border-black font-black text-xs py-2 uppercase shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[2px] active:translate-y-[2px] transition-all">
                Send Comment
              </button>
            </div>
          </div>

          <div id="mp-chat-status"
            class="mt-4 bg-gray-50 border-2 border-black p-3 text-[11px] font-mono leading-relaxed break-words">
            Multi-platform chat belum dikonfigurasi.
          </div>

          <div class="mt-4 bg-gray-50 border-2 border-black p-3 space-y-3">
            <div class="flex items-center justify-between gap-2">
              <h3 class="text-xs font-black uppercase">Auto Reply AI (YouTube/Facebook)</h3>
              <div id="mp-autoreply-pill"
                class="inline-flex items-center gap-2 text-[10px] font-bold uppercase px-2 py-1 border-2 border-black bg-white">
                <span class="w-2 h-2 rounded-full bg-gray-500"></span>
                <span>OFF</span>
              </div>
            </div>

            <div class="grid grid-cols-1 xl:grid-cols-4 gap-3">
              <label class="flex items-center gap-2 text-[11px] font-bold uppercase">
                <input id="mp-autoreply-enabled" type="checkbox" class="accent-black w-4 h-4 border-2 border-black">
                Enable Auto Reply
              </label>
              <label class="flex items-center gap-2 text-[11px] font-bold uppercase">
                <input id="mp-autoreply-platform-youtube" type="checkbox"
                  class="accent-black w-4 h-4 border-2 border-black" checked>
                YouTube
              </label>
              <label class="flex items-center gap-2 text-[11px] font-bold uppercase">
                <input id="mp-autoreply-platform-facebook" type="checkbox"
                  class="accent-black w-4 h-4 border-2 border-black" checked>
                Facebook
              </label>
              <select id="mp-autoreply-mode"
                class="bg-white border-2 border-black px-2 py-2 text-[11px] font-bold outline-none focus:bg-yellow-100">
                <option value="template_first">Template + AI Fallback</option>
                <option value="template_only">Template Only</option>
                <option value="ai_only">AI Only</option>
              </select>
            </div>

            <div class="grid grid-cols-1 xl:grid-cols-6 gap-2">
              <input id="mp-autoreply-cooldown" type="number" min="0" step="1"
                class="bg-white border-2 border-black px-2 py-2 text-[11px] font-bold outline-none focus:bg-yellow-100"
                placeholder="Cooldown(s)">
              <input id="mp-autoreply-max-user" type="number" min="1" step="1"
                class="bg-white border-2 border-black px-2 py-2 text-[11px] font-bold outline-none focus:bg-yellow-100"
                placeholder="Max/user">
              <input id="mp-autoreply-replies-per-comment" type="number" min="1" step="1"
                class="bg-white border-2 border-black px-2 py-2 text-[11px] font-bold outline-none focus:bg-yellow-100"
                placeholder="Balasan / komentar">
              <label class="flex items-center gap-2 text-[11px] font-bold uppercase bg-white border-2 border-black px-2 py-2">
                <input id="mp-autoreply-followup-enabled" type="checkbox"
                  class="accent-black w-4 h-4 border-2 border-black">
                Follow-up
              </label>
              <input id="mp-autoreply-followup-delay" type="number" min="3" step="1"
                class="bg-white border-2 border-black px-2 py-2 text-[11px] font-bold outline-none focus:bg-yellow-100"
                placeholder="Delay follow-up(s)">
              <input id="mp-autoreply-poll-ms" type="number" min="3000" step="1000"
                class="bg-white border-2 border-black px-2 py-2 text-[11px] font-bold outline-none focus:bg-yellow-100"
                placeholder="Poll ms (contoh 7000)">
            </div>

            <input id="mp-autoreply-price" type="text"
              class="w-full bg-white border-2 border-black px-3 py-2 text-xs font-mono outline-none focus:bg-yellow-100"
              placeholder="Info harga default (contoh: Rp99.000 / pcs)">

            <textarea id="mp-autoreply-templates"
              class="w-full bg-white border-2 border-black p-2 text-[11px] font-mono h-24 outline-none focus:bg-yellow-100"
              placeholder="Template per baris format:\nkeyword1,keyword2 | Halo @{username}, untuk harga {price}. Mau checkout?\norder,beli | Siap kak @{username}, lanjut checkout/DM ya."></textarea>

            <textarea id="mp-autoreply-followup-templates"
              class="w-full bg-white border-2 border-black p-2 text-[11px] font-mono h-20 outline-none focus:bg-yellow-100"
              placeholder="Follow-up template per baris:\nKak @{username}, kalau cocok langsung checkout/DM ya.\nStok terbatas kak @{username}, mau saya bantu proses sekarang?"></textarea>

            <textarea id="mp-autoreply-system"
              class="w-full bg-white border-2 border-black p-2 text-[11px] font-mono h-20 outline-none focus:bg-yellow-100"
              placeholder="System prompt AI Mistral untuk auto-reply YouTube/Facebook"></textarea>

            <div class="grid grid-cols-1 sm:grid-cols-3 gap-2">
              <button id="mp-autoreply-save"
                class="w-full bg-yellow-300 hover:bg-yellow-200 border-2 border-black font-black text-xs py-2 uppercase shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[2px] active:translate-y-[2px] transition-all">
                Save Auto Reply
              </button>
              <button id="mp-autoreply-runonce"
                class="w-full bg-cyan-300 hover:bg-cyan-200 border-2 border-black font-black text-xs py-2 uppercase shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[2px] active:translate-y-[2px] transition-all">
                Run Once
              </button>
              <button id="mp-autoreply-refresh"
                class="w-full bg-white hover:bg-gray-100 border-2 border-black font-black text-xs py-2 uppercase shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[2px] active:translate-y-[2px] transition-all">
                Refresh Setting
              </button>
            </div>

            <div id="mp-autoreply-status"
              class="bg-white border-2 border-black p-2 text-[11px] font-mono leading-relaxed break-words">
              Auto-reply multi-platform belum dikonfigurasi.
            </div>
          </div>
        </section>

        <section class="mb-8 bg-white border-2 border-black p-5 shadow-[5px_5px_0px_0px_rgba(0,0,0,1)]">
          <div class="flex items-center justify-between gap-3 mb-3 border-b-2 border-black pb-3">
            <h2 class="text-lg md:text-xl font-black uppercase tracking-wide flex items-center gap-2">
              <i class="fas fa-terminal"></i>
              System Log
            </h2>
            <button id="activity-log-clear"
              class="bg-white hover:bg-gray-100 border-2 border-black font-black text-[10px] px-3 py-1 uppercase shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[1px] active:translate-y-[1px] transition-all">
              Clear
            </button>
          </div>
          <div id="activity-log"
            class="h-56 overflow-y-auto bg-gray-50 border-2 border-black p-2 text-[11px] font-mono leading-relaxed">
            <div class="text-center text-gray-500 text-xs py-8">Belum ada log.</div>
          </div>
          <p class="mt-2 text-[10px] text-gray-600 font-medium">
            Log realtime untuk FFmpeg, Instagram live, auto-reply AI, dan multi-platform chat.
          </p>
        </section>

        <% if (videos.length===0) { %>
          <div
            class="bg-white border-2 border-black border-dashed p-12 text-center shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]">
            <div
              class="w-16 h-16 bg-gray-100 border-2 border-black flex items-center justify-center mx-auto mb-4 text-black">
              <i class="fas fa-film text-2xl"></i>
            </div>
            <h3 class="text-xl font-black text-black mb-2 uppercase">
              <%= t.no_streams %>
            </h3>
            <p class="text-black font-medium text-sm max-w-xs mx-auto mb-6">
              <%= t.upload_instruction %>
            </p>
            <button onclick="document.getElementById('add-video-btn').click()"
              class="text-black underline hover:text-pink-500 text-sm font-bold transition-colors">
              <%= t.upload_btn %> &rarr;
            </button>
          </div>
          <% } else { %>
            <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8 items-stretch">
              <% videos.forEach((video)=> { %>
                <div
                  class="bg-white border-2 border-black shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] hover:shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] hover:translate-x-[3px] hover:translate-y-[3px] transition-all duration-200 flex flex-col h-full"
                  id="card-<%= video.id %>">
                  <div class="aspect-video bg-black relative overflow-hidden border-b-2 border-black">
                    <video class="w-full h-full object-cover opacity-80"
                      poster="<%= video.thumbnail ? '/uploads/thumbnails/' + video.thumbnail : '' %>">
                      <% if (video.filename) { %>
                        <source src="/uploads/<%= video.filename %>" type="video/mp4">
                        <% } %>
                    </video>

                    <div class="absolute top-3 left-3 flex flex-col gap-2">
                      <div id="badge-<%= video.id %>"
                        class="bg-black text-[10px] font-bold px-2 py-1 text-white border border-white flex items-center gap-2">
                        <div class="w-2 h-2 rounded-none bg-red-500" id="dot-<%= video.id %>"></div>
                        <span id="status-<%= video.id %>">
                          <%= t.status_offline %>
                        </span>
                      </div>
                    </div>

                    <div class="absolute top-3 right-3">
                      <button
                        class="w-8 h-8 bg-white border-2 border-black text-black hover:bg-red-500 hover:text-white flex items-center justify-center transition-all delete-btn shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] hover:shadow-none hover:translate-x-[2px] hover:translate-y-[2px]"
                        data-id="<%= video.id %>">
                        <i class="fas fa-trash-alt text-xs"></i>
                      </button>
                    </div>

                    <div class="absolute bottom-0 left-0 right-0 bg-white border-t-2 border-black p-2">
                      <h3 class="font-bold text-black text-sm truncate uppercase">
                        <%= video.title %>
                      </h3>
                    </div>
                  </div>

                  <div class="p-4 flex-1 flex flex-col gap-4 mt-2">
                    <div class="space-y-3">
                      <div id="destinations-container-<%= video.id %>" class="space-y-2 max-h-52 overflow-y-auto pr-1">
                        <% if (video.destinations && video.destinations.length> 0) { %>
                          <% video.destinations.forEach((fullUrl, index)=> {
                            let type = 'custom';
                            let inputValue = fullUrl;

                            if (fullUrl.startsWith('rtmp://a.rtmp.youtube.com/live2/')) {
                            type = 'youtube';
                            inputValue = fullUrl.replace('rtmp://a.rtmp.youtube.com/live2/', '');
                            } else if (fullUrl.startsWith('rtmps://live-api-s.facebook.com:443/rtmp/')) {
                            type = 'facebook';
                            inputValue = fullUrl.replace('rtmps://live-api-s.facebook.com:443/rtmp/', '');
                            } else if (fullUrl.startsWith('rtmp://live.twitch.tv/app/')) {
                            type = 'twitch';
                            inputValue = fullUrl.replace('rtmp://live.twitch.tv/app/', '');
                            } else if (fullUrl.startsWith('rtmps://live-upload.instagram.com:443/rtmp/')) {
                            type = 'instagram';
                            inputValue = fullUrl.replace('rtmps://live-upload.instagram.com:443/rtmp/', '');
                            } else if (fullUrl.startsWith('rtmps://live-upload.instagram.com/rtmp/')) {
                            type = 'instagram';
                            inputValue = fullUrl.replace('rtmps://live-upload.instagram.com/rtmp/', '');
                            }
                            %>
                            <div class="flex flex-col gap-1 destination-row mb-2 border-b-2 border-black/10 pb-2">
                              <div class="flex items-stretch gap-1">
                                <select
                                  class="bg-gray-50 border-2 border-black px-2 py-2 text-[10px] font-bold outline-none focus:bg-yellow-100 uppercase platform-select font-mono w-24"
                                  onchange="updatePlaceholder(this)">
                                  <option value="custom" <%=type==='custom' ? 'selected' : '' %>>Custom</option>
                                  <option value="youtube" <%=type==='youtube' ? 'selected' : '' %>>YouTube</option>
                                  <option value="facebook" <%=type==='facebook' ? 'selected' : '' %>>Facebook</option>
                                  <option value="twitch" <%=type==='twitch' ? 'selected' : '' %>>Twitch</option>
                                  <option value="instagram" <%=type==='instagram' ? 'selected' : '' %>>Instagram</option>
                                </select>
                                <div class="relative group/input flex-1">
                                  <div class="absolute left-3 top-2.5 text-black z-20"><i
                                      class="fas fa-key text-xs"></i>
                                  </div>
                                  <input type="password" value="<%= inputValue %>"
                                    class="w-full h-full bg-gray-50 border-2 border-black px-3 pl-9 py-2 text-xs text-black focus:bg-yellow-100 outline-none transition-all placeholder-gray-500 font-mono destination-input relative z-10"
                                    placeholder="RTMP URL or Stream Key">
                                  <button type="button"
                                    onclick="const i = this.previousElementSibling; i.type = i.type === 'password' ? 'text' : 'password'; this.innerHTML = i.type === 'password' ? '<i class=\'fas fa-eye\'></i>' : '<i class=\'fas fa-eye-slash\'></i>';"
                                    class="absolute right-2 top-2 z-30 text-gray-500 hover:text-black">
                                    <i class="fas fa-eye"></i>
                                  </button>
                                </div>
                                <button type="button" onclick="this.closest('.destination-row').remove()"
                                  class="bg-red-500 text-white border-2 border-black w-8 flex items-center justify-center hover:bg-red-600 transition-colors shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[1px] active:translate-y-[1px]">
                                  <i class="fas fa-times text-xs"></i>
                                </button>
                              </div>
                              <div
                                class="prefix-display text-[10px] font-mono text-gray-500 pl-1 <%= type === 'custom' ? 'hidden' : 'block' %>">
                                <%= type !=='custom' ? 'Server: ' + (type==='youtube'
                                  ? 'rtmp://a.rtmp.youtube.com/live2/' : (type==='facebook'
                                  ? 'rtmps://live-api-s.facebook.com:443/rtmp/' : (type==='twitch'
                                  ? 'rtmp://live.twitch.tv/app/' : 'rtmps://live-upload.instagram.com:443/rtmp/' ))) : ''
                                  %>
                              </div>
                            </div>
                            <% }) %>
                              <% } else { %>
                                <div class="flex flex-col gap-1 destination-row mb-2 border-b-2 border-black/10 pb-2">
                                  <div class="flex items-stretch gap-1">
                                    <select
                                      class="bg-gray-50 border-2 border-black px-2 py-2 text-[10px] font-bold outline-none focus:bg-yellow-100 uppercase platform-select font-mono w-24"
                                      onchange="updatePlaceholder(this)">
                                      <option value="custom">Custom</option>
                                      <option value="youtube">YouTube</option>
                                      <option value="facebook">Facebook</option>
                                      <option value="twitch">Twitch</option>
                                      <option value="instagram">Instagram</option>
                                    </select>
                                    <div class="relative group/input flex-1">
                                      <div class="absolute left-3 top-2.5 text-black z-20"><i
                                          class="fas fa-key text-xs"></i></div>
                                      <input type="text" value=""
                                        class="w-full h-full bg-gray-50 border-2 border-black px-3 pl-9 py-2 text-xs text-black focus:bg-yellow-100 outline-none transition-all placeholder-gray-500 font-mono destination-input relative z-10"
                                        placeholder="RTMP URL (e.g. rtmp://site.com/live/key)">
                                    </div>
                                    <button type="button" onclick="this.closest('.destination-row').remove()"
                                      class="bg-red-500 text-white border-2 border-black w-8 flex items-center justify-center hover:bg-red-600 transition-colors shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[1px] active:translate-y-[1px]">
                                      <i class="fas fa-times text-xs"></i>
                                    </button>
                                  </div>
                                <div class="prefix-display text-[10px] font-mono text-gray-500 pl-1 hidden"></div>
                                </div>
                      </div>
                      <% } %>
                    </div>

                    <button type="button" onclick="addDestination('<%= video.id %>')"
                      class="w-full bg-cyan-100 hover:bg-cyan-200 text-black border-2 border-black py-1.5 text-[10px] font-bold uppercase transition-colors border-dashed">
                      + <%= t.add_destination || 'Add Destination' %>
                    </button>
                  </div>

                  <div class="grid grid-cols-3 gap-2">
                    <select id="res-<%= video.id %>"
                      class="bg-white border-2 border-black px-2 py-1.5 text-[10px] text-black font-bold outline-none focus:bg-cyan-100">
                      <option value="852x480" <%=video.resolution==='852x480' ? 'selected' : '' %>>480p</option>
                      <option value="1280x720" <%=(!video.resolution || video.resolution==='1280x720' ) ? 'selected'
                        : '' %>>720p</option>
                      <option value="1920x1080" <%=video.resolution==='1920x1080' ? 'selected' : '' %>>1080p</option>
                    </select>
                    <select id="fps-<%= video.id %>"
                      class="bg-white border-2 border-black px-2 py-1.5 text-[10px] text-black font-bold outline-none focus:bg-cyan-100">
                      <option value="24" <%=video.fps==='24' ? 'selected' : '' %>>24 FPS</option>
                      <option value="30" <%=(!video.fps || video.fps==='30' ) ? 'selected' : '' %>>30 FPS</option>
                      <option value="60" <%=video.fps==='60' ? 'selected' : '' %>>60 FPS</option>
                    </select>
                    <select id="bit-<%= video.id %>"
                      class="bg-white border-2 border-black px-2 py-1.5 text-[10px] text-black font-bold outline-none focus:bg-cyan-100">
                      <option value="2500k" <%=(!video.bitrate || video.bitrate==='2500k' ) ? 'selected' : '' %>
                        >Standard (2500k)</option>
                      <option value="4500k" <%=video.bitrate==='4500k' ? 'selected' : '' %>>High (4500k)</option>
                      <option value="6000k" <%=video.bitrate==='6000k' ? 'selected' : '' %>>Ultra (6000k)</option>
                      <option value="8000k" <%=video.bitrate==='8000k' ? 'selected' : '' %>>Extreme (8000k)</option>
                    </select>
                  </div>

                  <div class="flex items-center justify-between mt-auto pt-2 border-t-2 border-black border-dashed">
                    <label class="flex items-center gap-2 cursor-pointer group/check select-none">
                      <input type="checkbox" id="loop-<%= video.id %>" <%=video.loop ? 'checked' : '' %>
                      class="accent-black w-4 h-4 border-2 border-black rounded-none focus:ring-0">
                      <span
                        class="text-[10px] text-black font-bold uppercase group-hover/check:text-pink-600 transition-colors">
                        <%= t.loop_video %>
                      </span>
                    </label>
                    <button onclick="saveConfig('<%= video.id %>')"
                      class="bg-white hover:bg-yellow-300 text-black border-2 border-black px-2 py-0.5 text-[10px] font-bold shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[1px] active:translate-y-[1px] transition-all"
                      title="Save Configuration">
                      <i class="fas fa-save"></i> SAVE
                    </button>
                  </div>

                  <button
                    class="w-full bg-black text-white hover:bg-white hover:text-black border-2 border-black font-black py-2.5 transition-all start-btn shadow-[4px_4px_0px_0px_rgba(0,0,0,0.2)] hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] text-xs flex items-center justify-center gap-2 uppercase tracking-wider"
                    data-id="<%= video.id %>" data-running="<%= Boolean(video.start_time) %>"
                    data-start-time="<%= video.start_time || '' %>">
                    <i class="fas fa-play text-[10px]"></i> <span>
                      <%= video.start_time ? 'Stop Stream' : t.start_stream %>
                    </span>
                  </button>
                </div>
            </div>
            <% }) %>
    </div>
    <% } %>

      </main>
      </div>

      <div id="uploadModal" class="fixed inset-0 bg-black/80 z-[60] hidden flex items-center justify-center p-4">
        <div
          class="bg-white w-full max-w-lg border-4 border-black box-shadow shadow-[8px_8px_0px_0px_rgba(255,255,255,1)] p-6 relative">
          <div class="flex items-center justify-between mb-6 border-b-2 border-black pb-4">
            <h2 class="text-2xl font-black text-black uppercase flex items-center gap-2"><i
                class="fas fa-cloud-upload-alt"></i>
              <%= t.upload_btn %>
            </h2>
            <button id="closeModal"
              class="text-black hover:bg-black hover:text-white border-2 border-black transition-colors w-8 h-8 flex items-center justify-center"><i
                class="fas fa-times"></i></button>
          </div>

          <form id="uploadForm" class="space-y-5">
            <div>
              <label
                class="block text-xs font-bold text-black uppercase mb-1.5 bg-yellow-300 inline-block px-1 border-2 border-black">
                <%= t.upload_title %>
              </label>
              <input type="text" name="title"
                class="w-full bg-white border-2 border-black px-4 py-3 text-sm text-black focus:bg-yellow-50 outline-none transition-all placeholder-gray-400 font-bold"
                placeholder="E.G. MY AWESOME STREAM" required>
            </div>

            <div>
              <label
                class="block text-xs font-bold text-black uppercase mb-1.5 bg-cyan-300 inline-block px-1 border-2 border-black">
                <%= t.upload_url_label %>
              </label>
              <input type="text" id="videoUrlInput" name="videoUrl"
                class="w-full bg-white border-2 border-black px-4 py-3 text-sm text-black focus:bg-cyan-50 outline-none transition-all placeholder-gray-400 font-mono"
                placeholder="https://www.youtube.com/watch?v=xxxx">
              <div class="text-[11px] text-gray-600 font-semibold mt-2">
                <%= t.upload_source_hint %>
              </div>
            </div>

            <div
              class="border-2 border-dashed border-black bg-gray-50 p-8 text-center cursor-pointer hover:bg-cyan-50 transition-all group relative"
              id="dropZone">
              <input type="file" name="video" id="videoInput" accept="video/mp4" class="hidden">
              <div
                class="w-14 h-14 bg-white border-2 border-black flex items-center justify-center mx-auto mb-3 text-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] group-hover:translate-x-[2px] group-hover:translate-y-[2px] group-hover:shadow-none transition-all">
                <i class="fas fa-file-video text-xl"></i>
              </div>
              <div id="fileName" class="text-sm font-black text-black uppercase">
                <%= t.upload_file %>
              </div>
              <div class="text-xs text-gray-500 mt-1 font-bold">
                <%= t.mp4_only %>
              </div>
            </div>

            <button type="submit"
              class="w-full bg-lime-400 hover:bg-lime-300 text-black border-2 border-black font-black py-4 shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-x-[4px] active:translate-y-[4px] transition-all flex items-center justify-center gap-2 uppercase tracking-widest text-lg">
              <span>
                <%= t.upload_submit %>
              </span>
              <i class="fas fa-arrow-right"></i>
            </button>
          </form>
        </div>
      </div>

      <script src="/socket.io/socket.io.js"></script>
      <script src="/js/script.js"></script>
      <script>
        const sidebar = document.getElementById('sidebar');
        const mobileOverlay = document.getElementById('mobile-overlay');
        const openSidebarBtn = document.getElementById('open-sidebar');
        const closeSidebarBtn = document.getElementById('close-sidebar');

        function toggleSidebar() {
          const isClosed = sidebar.classList.contains('-translate-x-full');
          if (isClosed) {
            sidebar.classList.remove('-translate-x-full');
            mobileOverlay.classList.remove('hidden');
          } else {
            sidebar.classList.add('-translate-x-full');
            mobileOverlay.classList.add('hidden');
          }
        }

        if (openSidebarBtn) openSidebarBtn.addEventListener('click', toggleSidebar);
        if (closeSidebarBtn) closeSidebarBtn.addEventListener('click', toggleSidebar);
        if (mobileOverlay) mobileOverlay.addEventListener('click', toggleSidebar);
      </script>
</body>

</html>
